import Layout from '../../../components/layout';
import {BlogImage, Meta, Caption} from '../../../components/blog';
import {Block} from 'baseui/block';
import {StatefulInput} from 'baseui/input';
import {StatefulSelect} from 'baseui/select';
import {StatefulPaymentCard} from 'baseui/payment-card';
import {StatefulPhoneInput} from 'baseui/phone-input';
import metadata from './metadata.json';

import aspectRatioBoxGif from './aspect-ratio-box.gif';
import responsiveDashboardGif from './responsive-dashboard.gif';
import responsiveHideGif from './responsive-hide.gif';
import responsiveLoadStatusGif from './responsive-load-status.gif';
import responsiveNavBarGif from './responsive-nav-bar.gif';
import viewportMetaTagGif from './viewport-meta-tag.gif';

export default Layout;

<Meta data={metadata} />

<BlogImage
  src="/static/images/blog/responsive-web/responsive-shipper-tools.svg"
  alt="mobile, laptop, and desktop devices running a web application"
  caption="Responsive apps work across mobile and desktop"
/>

When building web applications, it is important to make things accessible to as many people as possible. [More and more people are relying on their phones to access the web](https://www.pewinternet.org/fact-sheet/mobile/), which means we need to prioritize building our applications to work on smaller form factors. Here are some tips and tricks for using Base Web to build UIs for both mobile and desktop.

## Setting the viewport meta tag

Before we begin, we should set the viewport meta tag.

<BlogImage
  src={viewportMetaTagGif}
  alt="resizing the window smaller and seeing the content shrink as the window gets thinner and thinner"
  caption="Default behavior for resizing the browser shrinks content to fit the window width"
/>

The default browser behavior is to shrink the page until the entire width of the page is visible, forcing the user to pan and zoom on small devices. This behavior, however, is undesirable once you build a responsive app, and wish to see the content at its intended scale. In order properly size the content based on the device width, you will need to set the viewport `<meta>` in your `<head>` (or [`<Helmet>`](https://github.com/nfl/react-helmet))

```js
<head> // or <Helmet>
  <meta
    name="viewport"
    content="width=device-width, initial-scale=1, shrink-to-fit=no"
  />
</head>
```

This meta tag was originally introduced by [Apple](https://developer.apple.com/library/archive/documentation/AppleApplications/Reference/SafariWebContent/UsingtheViewport/UsingtheViewport.html) for iOS Safari, but has since become an industry standard for controlling the viewport’s size and scale.

- **`width=device-width`** sets the width of the page equal to the width of the device or window. E.g. if your screen has a width of 375px, then `width: 100%` will by default set width to 375px.
- **`initial-scale=1`** tells the browser to start at the 1:1 zoom level.
- **`shrink-to-fit=no`** further prevents the page from scaling down in the event that you have elements on the page that overflow (either intentionally or unintentionally) the viewport bounds.

## Custom breakpoints

In many cases, you would want to override Base Web’s breakpoints with your own. The default breakpoints for Base Web are:

- **`small: 320`**
- **`medium: 600`**
- **`large: 1280`**

To override these, we recommend creating your own mapping, as well as generating the respective `min-width` media query strings using `getMediaQuery()` ([v6.19.0](https://github.com/uber-web/baseui/releases/tag/v6.19.0)+), so we could target different screen widths for styling:

```js
const MyBreakpoints = {
  small: 769,
  medium: 1024,
  large: 1216,
};

const ResponsiveTheme = Object.keys(MyBreakpoints).reduce(
  (acc, key) => {
    acc.breakpoints[key] = MyBreakpoints[key];
    acc.media[key] = getMediaQuery({
      'min-width': `${MyBreakpoints[key]}px`,
    });
    return acc;
  },
  {
    breakpoints: {},
    media: {},
  },
);

export const MyTheme = {
  ...LightTheme,
  ...ResponsiveTheme,
};
```

This sets the following values inside `MyTheme`:

```json
{
  "breakpoints": {
    "small": 769
    "medium": 1024,
    "large": 1216,
  },
  "media": {
    "small": "@media screen and (min-width: 769px)"
    "medium": "@media screen and (min-width: 1024px)",
    "large": "@media screen and (min-width: 1216px)",
  }
}
```

Then you can use `MyTheme` throughout your app using Base Web’s [`ThemeProvider`](/theming/custom-themes#the-themeprovider).

## Styling components using `themedStyled()`

Now that our theme is set up, we can start using it to create styled components using `themeStyled()`. Using the media queries we created above, we will write the mobile styles first, and add desktop styles under the media query key:

```js
const LoadStatus = themedStyled('span', ({$theme}) => ({
  ...$theme.typography.font350,
  color: $theme.colors.mono800,
  [$theme.media.small]: {
    ...$theme.typography.font500,
    color: $theme.colors.mono900,
  },
}));
```

With our small breakpoint of 769px, this means that the component will change font and color as the screen increases past 769px:

<BlogImage
  src={responsiveLoadStatusGif}
  alt="resizing the window smaller and seeing the pink-highlighted text change size and color"
  caption="LoadStatus component, highlighted in pink, changes font and color on mobile"
/>

## Block responsive API

The [Block](/components/block/#responsive-layouts) component accepts props either as a single value or an array of values. When an array is used, it will generate media queries based on the current theme breakpoints.

This gives us a simpler way of creating components:

```js
const NavBar = props => (
  <Block
    height={['scale1400', 'scale1600']}
    paddingLeft={['scale800', 'scale1200']}
    paddingRight={['scale800', 'scale1200']}
    {...props}
  />
);

// is equivalent to

const NavBar = themedStyled('div', ({$theme}) => ({
  height: $theme.sizing.scale1400,
  paddingRight: $theme.sizing.scale800,
  paddingLeft: $theme.sizing.scale800,
  [$theme.media.small]: {
    height: $theme.sizing.scale1600,
    paddingRight: $theme.sizing.scale1200,
    paddingLeft: $theme.sizing.scale1200,
  },
}));
```

<BlogImage
  src={responsiveNavBarGif}
  alt="resizing the window smaller and seeing the yellow-highlighted nav bar change height and padding"
  caption="NavBar component, highlighted in yellow, changes height and padding on mobile"
/>

## Mobile-only or desktop-only Blocks

We can also take advantage of these responsive properties to completely hide a Block component using CSS `display: none`.

```js
// NavLink appears only on desktop
const NavLink = props => <Block display={['none', 'block']} {...props} />;

// TabLink appears only on desktop
const TabLink = props => <Block display={['block', 'none']} {...props} />;
```

<BlogImage
  src={responsiveHideGif}
  alt="resizing the window smaller and seeing the green-highlighted components appear or disappear"
  caption="Mobile/desktop-only components, highlighted in green, appear or disappear on mobile"
/>

## FlexGrid component

Another handy tool for building responsive UIs is the [FlexGrid](/components/flex-grid/) component ([v6.19.0](https://github.com/uber-web/baseui/releases/tag/v6.19.0)+). This component lets you build grid layouts using CSS flexbox, supporting Internet Explorer 10+ users. It sets gaps between the columns and rows using `:nth-child` and `:nth-last-child` math, and also allows for responsive prop arrays like the [Block](/components/block/#responsive-layouts) component.

```js
// Example usage
const Filters = () => (
  <FlexGrid columnCount={[2, 4]} columnGap="scale300" rowGap="scale800">
    <FlexGridItem>All Shipments</FlexGridItem>
    <FlexGridItem>In Progress</FlexGridItem>
    <FlexGridItem>Upcoming</FlexGridItem>
    <FlexGridItem>Past</FlexGridItem>
  </FlexGrid>
);

const Facilities = (Pickup, Dropoff) => (
  <FlexGrid columnCount={[1, 2]} columnGap="scale300" rowGap="scale300">
    <FlexGridItem>
      <Pickup />
    </FlexGridItem>
    <FlexGridItem>
      <Dropoff />
    </FlexGridItem>
  </FlexGrid>
);
```

<BlogImage
  src={responsiveDashboardGif}
  alt="resizing the window smaller and seeing the red-highlighted grid components change column-counts"
  caption="FlexGrid components, highlighted in red, change column-counts on mobile"
/>

## AspectRatioBox component

On slower network connections, especially apparent on mobile networks, images can cause content to reflow as they are downloaded. When browsers see an image tag, they typically do not know how much space to allocate for it until it begins downloading the image headers, which can take some time.

In order to avoid these reflows, we can take advantage of the [AspectRatioBox](/components/aspect-ratio-box) component ([v7.5.0](https://github.com/uber-web/baseui/releases/tag/v7.5.0)+), which allows us to specify the aspect ratio for an element ahead of time using CSS (see [CSS-Tricks](https://css-tricks.com/aspect-ratio-boxes/#article-header-id-6) for how this works).

```js
// Example usage
<AspectRatioBox aspectRatio={300 / 117}>
  <AspectRatioBoxBody
    as="img"
    src={assetUrl('/static/error-image.svg')}
    alt="Truck with scuba-gear on ocean floor with octopus and
         fishes behind it"
  />
</AspectRatioBox>
```

<BlogImage
  src={aspectRatioBoxGif}
  alt="side-by-side comparison of app loading, left with an image that reflows on load"
  caption="Right image uses AspectRatioBox component to prevent reflows on slower networks."
/>

## Final thoughts

Base Web gives you a few components with responsive design in mind, from Block, to FlexGrid, to AspectRatioBox. We hope this guide can help you build responsive apps, making them accessible to even more users.
